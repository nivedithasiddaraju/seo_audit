<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Smart SEO Auditor</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <header>
      <h1>ğŸŒ Smart SEO Auditor</h1>
      <p>Analyze, Fix & Optimize Your Website with AI!</p>
    </header>

    <main class="card">
      <form method="POST" class="url-form">
        <input
          type="text"
          name="website_url"
          placeholder="Enter website URL (e.g. https://example.com)"
          required
        />
        <label>Do you own this website?</label>
        <select name="ownership" required>
          <option value="no">No</option>
          <option value="yes">Yes</option>
        </select>
        <button type="submit">Analyze ğŸš€</button>
      </form>

      {% if result %} {% if result.error %}
      <p class="error">{{ result.error }}</p>
      {% else %}
      <div class="results">
        <h2>ğŸ” SEO Report for {{ result.url }}</h2>

        <div class="chart-box">
          <canvas id="seoChart"></canvas>
          <p class="score-text">SEO Score: {{ result.seo_score }}%</p>
        </div>

        <p><strong>Platform:</strong> {{ result.platform }}</p>
        <p class="ownership-msg">{{ result.ownership_message }}</p>

        <div class="metrics">
          <p><strong>Title:</strong> {{ result.title }}</p>
          <p><strong>Meta Description:</strong> {{ result.meta_desc }}</p>
          <p><strong>H1 Tags:</strong> {{ result.h1_count }}</p>
          <p><strong>Images Missing Alt:</strong> {{ result.missing_alt }}</p>
          <p><strong>Links Found:</strong> {{ result.link_count }}</p>
          <p><strong>Load Time:</strong> {{ result.load_time }}s</p>
        </div>

        {% if result.report %}
        <div class="issues">
          <h3>âš ï¸ Issues Found</h3>
          <ul>
            {% for issue in result.report %}
            <li>{{ issue }}</li>
            {% endfor %}
          </ul>
        </div>

        <div class="issues">
          <h3>âœ… AI Recommendations</h3>
          <ul>
            {% for fix in result.fixes %}
            <li>{{ fix }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %} {% if result.fixed_path %}
        <a
          class="download-btn"
          href="{{ url_for('serve_fixed_files', filename='corrected_page.html') }}"
          target="_blank"
          >ğŸ› ï¸ View AI-Fixed Page</a
        >
        {% endif %}

        <form method="POST" action="/download">
          {% for key, value in result.items() %}
          <input type="hidden" name="{{ key }}" value="{{ value }}" />
          {% endfor %}
          <button class="download-btn">ğŸ“„ Download PDF Report</button>
        </form>
      </div>
      {% endif %} {% endif %}
    </main>

    <footer>
      <p>Made with ğŸ’™ | Smart SEO Auditor</p>
    </footer>

    {% if result and not result.error %}
    <script>
      const ctx = document.getElementById('seoChart').getContext('2d');
      const score = {{ result.seo_score }};
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          datasets: [{
            data: [score, 100 - score],
            backgroundColor: [score >= 80 ? '#00c853' : score >= 60 ? '#ffb300' : '#e53935', '#e0e0e0'],
            borderWidth: 0
          }]
        },
        options: { cutout: '70%', plugins: { legend: { display: false } } }
      });
    </script>
    {% endif %}
  </body>
</html>
